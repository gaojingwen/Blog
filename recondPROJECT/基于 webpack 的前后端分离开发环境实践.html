<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>åŸºäº webpack çš„å‰åç«¯åˆ†ç¦»å¼€å‘ç¯å¢ƒå®è·µ | å°ä¸‰èƒ–æŠ€æœ¯æ ˆ</title>
    <meta name="description" content="ä½›ç³»å‰ç«¯å¤§ç¥">
    <meta charset="UTF-8">
  <link rel="icon" href="/Blog/favicon.ico">
    
    <link rel="preload" href="/Blog/assets/css/0.styles.9ba1bd5b.css" as="style"><link rel="preload" href="/Blog/assets/js/app.b624378b.js" as="script"><link rel="preload" href="/Blog/assets/js/41.259d1527.js" as="script"><link rel="prefetch" href="/Blog/assets/js/25.812a025f.js"><link rel="prefetch" href="/Blog/assets/js/2.6f79cb1b.js"><link rel="prefetch" href="/Blog/assets/js/3.d16a0c2c.js"><link rel="prefetch" href="/Blog/assets/js/4.981975ce.js"><link rel="prefetch" href="/Blog/assets/js/5.22251c73.js"><link rel="prefetch" href="/Blog/assets/js/6.628e770d.js"><link rel="prefetch" href="/Blog/assets/js/7.07e2b6b4.js"><link rel="prefetch" href="/Blog/assets/js/8.2bccae8e.js"><link rel="prefetch" href="/Blog/assets/js/9.5fab895e.js"><link rel="prefetch" href="/Blog/assets/js/10.322ce4df.js"><link rel="prefetch" href="/Blog/assets/js/11.006e4719.js"><link rel="prefetch" href="/Blog/assets/js/12.3333e057.js"><link rel="prefetch" href="/Blog/assets/js/13.1af90041.js"><link rel="prefetch" href="/Blog/assets/js/14.182c46a3.js"><link rel="prefetch" href="/Blog/assets/js/15.1cbbb4a1.js"><link rel="prefetch" href="/Blog/assets/js/16.49b9f0b6.js"><link rel="prefetch" href="/Blog/assets/js/17.29b175e7.js"><link rel="prefetch" href="/Blog/assets/js/18.297427c5.js"><link rel="prefetch" href="/Blog/assets/js/19.2663f562.js"><link rel="prefetch" href="/Blog/assets/js/20.b7420290.js"><link rel="prefetch" href="/Blog/assets/js/21.d39c8908.js"><link rel="prefetch" href="/Blog/assets/js/22.f1126d66.js"><link rel="prefetch" href="/Blog/assets/js/23.4a7a29be.js"><link rel="prefetch" href="/Blog/assets/js/24.e6bca216.js"><link rel="prefetch" href="/Blog/assets/js/26.9960f054.js"><link rel="prefetch" href="/Blog/assets/js/27.fc3fad79.js"><link rel="prefetch" href="/Blog/assets/js/28.cd83fc3d.js"><link rel="prefetch" href="/Blog/assets/js/29.443e4941.js"><link rel="prefetch" href="/Blog/assets/js/30.6a8a17b9.js"><link rel="prefetch" href="/Blog/assets/js/31.8fc47db9.js"><link rel="prefetch" href="/Blog/assets/js/32.b715a23d.js"><link rel="prefetch" href="/Blog/assets/js/33.518efbd0.js"><link rel="prefetch" href="/Blog/assets/js/34.76e7b1b1.js"><link rel="prefetch" href="/Blog/assets/js/35.f8a6b00b.js"><link rel="prefetch" href="/Blog/assets/js/36.8c12af51.js"><link rel="prefetch" href="/Blog/assets/js/37.cda5ca1d.js"><link rel="prefetch" href="/Blog/assets/js/38.60935ef0.js"><link rel="prefetch" href="/Blog/assets/js/39.26c637dd.js"><link rel="prefetch" href="/Blog/assets/js/40.44a0bfa7.js"><link rel="prefetch" href="/Blog/assets/js/42.ab80d836.js"><link rel="prefetch" href="/Blog/assets/js/43.0af190a7.js"><link rel="prefetch" href="/Blog/assets/js/44.093f7743.js"><link rel="prefetch" href="/Blog/assets/js/45.8c17580f.js"><link rel="prefetch" href="/Blog/assets/js/46.fd30eace.js"><link rel="prefetch" href="/Blog/assets/js/47.214dd0f8.js"><link rel="prefetch" href="/Blog/assets/js/48.d43dc2ae.js"><link rel="prefetch" href="/Blog/assets/js/49.6136b23c.js"><link rel="prefetch" href="/Blog/assets/js/50.fd4e81e2.js"><link rel="prefetch" href="/Blog/assets/js/51.9fa346c5.js"><link rel="prefetch" href="/Blog/assets/js/52.6e5d9385.js"><link rel="prefetch" href="/Blog/assets/js/53.19db09c4.js">
    <link rel="stylesheet" href="/Blog/assets/css/0.styles.9ba1bd5b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Blog/" class="home-link router-link-active"><!----> <span class="site-name">å°ä¸‰èƒ–æŠ€æœ¯æ ˆ</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Blog/recondRESUME/" class="nav-link">Resume</a></div><div class="nav-item"><a href="/Blog/recondCSS/" class="nav-link">Css</a></div><div class="nav-item"><a href="/Blog/recondJAVASCRIPT/" class="nav-link">Javascript</a></div><div class="nav-item"><a href="/Blog/recondVUE/" class="nav-link">Vue</a></div><div class="nav-item"><a href="/Blog/recondNODE/" class="nav-link">Node</a></div><div class="nav-item"><a href="/Blog/recondES6/" class="nav-link">Es6</a></div><div class="nav-item"><a href="/Blog/recondPROJECT/" class="nav-link router-link-active">projectify</a></div><div class="nav-item"><a href="/Blog/recondSUMMARY/" class="nav-link">summary</a></div><div class="nav-item"><a href="/Blog/recondFEATURE/" class="nav-link">feature</a></div><div class="nav-item"><a href="/Blog/recondGIT/" class="nav-link">git</a></div><div class="nav-item"><a href="/Blog/recondOTHER/" class="nav-link">other</a></div><div class="nav-item"><a href="https://github.com/gaojingwen" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHubåœ°å€
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Blog/recondRESUME/" class="nav-link">Resume</a></div><div class="nav-item"><a href="/Blog/recondCSS/" class="nav-link">Css</a></div><div class="nav-item"><a href="/Blog/recondJAVASCRIPT/" class="nav-link">Javascript</a></div><div class="nav-item"><a href="/Blog/recondVUE/" class="nav-link">Vue</a></div><div class="nav-item"><a href="/Blog/recondNODE/" class="nav-link">Node</a></div><div class="nav-item"><a href="/Blog/recondES6/" class="nav-link">Es6</a></div><div class="nav-item"><a href="/Blog/recondPROJECT/" class="nav-link router-link-active">projectify</a></div><div class="nav-item"><a href="/Blog/recondSUMMARY/" class="nav-link">summary</a></div><div class="nav-item"><a href="/Blog/recondFEATURE/" class="nav-link">feature</a></div><div class="nav-item"><a href="/Blog/recondGIT/" class="nav-link">git</a></div><div class="nav-item"><a href="/Blog/recondOTHER/" class="nav-link">other</a></div><div class="nav-item"><a href="https://github.com/gaojingwen" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHubåœ°å€
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>projectify</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Blog/recondPROJECT/" class="sidebar-link">å¤§ç¬¨è›‹</a></li><li><a href="/Blog/recondPROJECT/web å‰ç«¯ä¼˜åŒ–.html" class="sidebar-link">web å‰ç«¯ä¼˜åŒ–</a></li><li><a href="/Blog/recondPROJECT/åŸºäº webpack çš„å‰åç«¯åˆ†ç¦»å¼€å‘ç¯å¢ƒå®è·µ.html" class="active sidebar-link">åŸºäº webpack çš„å‰åç«¯åˆ†ç¦»å¼€å‘ç¯å¢ƒå®è·µ</a></li><li><a href="/Blog/recondPROJECT/å¾ˆå…¨å¾ˆå…¨çš„ JavaScript æ¨¡å—è®²è§£.html" class="sidebar-link">å¾ˆå…¨å¾ˆå…¨çš„ JavaScript æ¨¡å—è®²è§£</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="åŸºäº-webpack-çš„å‰åç«¯åˆ†ç¦»å¼€å‘ç¯å¢ƒå®è·µ"><a href="#åŸºäº-webpack-çš„å‰åç«¯åˆ†ç¦»å¼€å‘ç¯å¢ƒå®è·µ" aria-hidden="true" class="header-anchor">#</a> åŸºäº webpack çš„å‰åç«¯åˆ†ç¦»å¼€å‘ç¯å¢ƒå®è·µ</h1> <p>[å‰ç«¯å¤§å­¦](javascript:void(0)ğŸ˜‰ <em>4æœˆ10æ—¥</em></p> <blockquote><p>æ¥æºï¼šä»Šæ—¥å¤´æ¡æŠ€æœ¯åšå®¢</p></blockquote> <p><strong>èƒŒæ™¯</strong></p> <p>éšç€äº’è”ç½‘åº”ç”¨å·¥ç¨‹è§„æ¨¡çš„æ—¥ç›Šå¤æ‚åŒ–å’Œç²¾ç»†åŒ–ï¼Œæˆ‘ä»¬åœ¨å¼€å‘ä¸€ä¸ªæ ‡å‡†webåº”ç”¨çš„æ—©å·²å¼€å§‹å‘Šåˆ«å•å¹²æ¨¡å¼ï¼Œä¸ºäº†æå‡å¼€å‘æ•ˆç‡ï¼Œå‰åç«¯åˆ†ç¦»çš„éœ€æ±‚è¶Šæ¥è¶Šè¢«é‡è§†ï¼Œå‰ç«¯è´Ÿè´£å±•ç°/äº¤äº’é€»è¾‘ï¼Œåç«¯è´Ÿè´£ä¸šåŠ¡/æ•°æ®æ¥å£ï¼ŒåŸºæœ¬ä¸Šä¹Ÿæˆä¸ºäº†æˆ‘ä»¬æ—¥å¸¸é¡¹ç›®åˆ†å·¥ä¸­çš„æ ‡é…ï¼Œä½†æ˜¯å‰åç«¯åˆ†ç¦»ä¸€ç›´ä»¥æ¥éƒ½æ˜¯ä¸€ä¸ªå·¥ç¨‹æ¦‚å¿µï¼Œæ¯ä¸ªå›¢é˜Ÿåœ¨å®ç°å·¥ç¨‹ä¸­éƒ½ä¼šåŸºäºè‡ªèº«çš„æŠ€æœ¯æ ˆé€‰æ‹©å’Œå¼€å‘ç¯å¢ƒè¿›è¡Œå…·ä½“çš„å®ç°ï¼Œæœ¬æ–‡ä¾¿æ ¹æ®è‡ªèº«å›¢é˜Ÿåœ¨webapckå¼€å‘ä¸­æ­å»ºçš„å‰åç«¯åˆ†ç¦»å¼€å‘ç¯å¢ƒè¿›è¡Œéƒ¨åˆ†å™è¿°ã€‚</p> <p><strong>ç†æƒ³åŒ–çš„å‰åç«¯åˆ†ç¦»ç¯å¢ƒ</strong></p> <p>ç›®å‰ä¸šç•Œæ¯”è¾ƒæœ‰ä»£è¡¨æ€§çš„å‰åç«¯åˆ†ç¦»çš„ä¾‹å­æ˜¯SPA(Single-page application)ï¼Œæ‰€æœ‰ç”¨åˆ°çš„å±•ç°æ•°æ®éƒ½æ˜¯åç«¯é€šè¿‡å¼‚æ­¥æ¥å£(AJAX/JSONP/WEBSOCKET)çš„æ–¹å¼æä¾›çš„ï¼Œç°å¦‚ä»Šæœ€ç«çš„å‰ç«¯æ¡†æ¶å¦‚ï¼šReactï¼Œ Vueï¼ŒAngularç­‰ä¹Ÿéƒ½æ¨èé‡‡ç”¨SPAçš„æ¨¡å¼è¿›è¡Œå¼€å‘å¹¶ä¸”ä»ç»„ä»¶åŒ–ï¼Œæ•°æ®æµï¼ŒçŠ¶æ€å®¹å™¨å†åˆ°ç½‘ç»œè¯·æ±‚ï¼Œå•é¡µè·¯ç”±ç­‰éƒ½ç»™å‡ºäº†å®Œå–„çš„å…¨å®¶æ¡¶æ–¹æ¡ˆã€‚ä»æŸç§æ„ä¹‰ä¸Šæ¥è¯´ï¼ŒSPAç¡®å®åšåˆ°äº†å‰åç«¯åˆ†ç¦»ï¼Œä½†è¿™ç§æ–¹å¼å­˜åœ¨å¦‚ä¸‹å‡ ä¸ªäºŸå¾…é—®é¢˜ï¼š</p> <ul><li>å‰ç«¯å¼€å‘æœ¬åœ°å¼€å‘ç¯å¢ƒä¸‹è¯¥å¦‚ä½•çªç ´åŸŸçš„é™åˆ¶å’ŒæœåŠ¡ç«¯æ¥å£è¿›è¡Œé€šä¿¡ï¼Ÿ</li> <li>ä¸€æ¡å‘½ä»¤ï¼Œèƒ½å¦åŒæ—¶å®Œæˆwebpackå’Œnode serverçš„å¯åŠ¨ï¼Ÿ</li> <li>å¼€å‘ç¯å¢ƒä¸‹çš„å‰ç«¯èµ„æºè·¯å¾„åº”è¯¥å¦‚ä½•é…ç½®ï¼Ÿ</li> <li>mockæ•°æ®åº”è¯¥æ€ä¹ˆåšï¼Ÿ</li> <li>æ‰“åŒ…æ„å»ºåçš„æ–‡ä»¶èƒ½å¦ç›´æ¥é¢„è§ˆæ•ˆæœï¼Ÿ</li></ul> <p>é’ˆå¯¹ä»¥ä¸Šçš„é—®é¢˜ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ€æ ·åˆ©ç”¨webpackç°æœ‰çš„ä¸€äº›æœºåˆ¶å’Œå€ŸåŠ©nodeçš„ç¯å¢ƒæ­é…æ¥è¿›è¡Œé€ä¸ªå‡»ç ´ï¼Œå…·ä½“è®¾è®¡è§ä¸‹å›¾ï¼š</p> <p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/zPh0erYjkib1ANRIb98ZRKrZ03Xbc7UocDGun6V4ZqYEibGUNpW8czpQOT1sRhjHiakugvmgPcau66I7XhG9y6F1w/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="img"></p> <p>ç”±æ­¤å¯è§ï¼Œæˆ‘ä»¬ç†æƒ³åŒ–çš„å¼€å‘ç¯å¢ƒåº”æ ¹æ®å…·å¤‡ä»¥ä¸‹å‡ ç‚¹è¦æ±‚ï¼š</p> <ul><li>æ“ä½œå¤Ÿç®€å•ï¼Œæ‹‰ä¸‹ä»£ç åï¼Œåªéœ€è¦è®°ä½ä»…æœ‰çš„å‡ ä¸ªå‘½ä»¤å°±èƒ½ç›´æ¥è¿›å…¥å¼€å‘çŠ¶æ€</li> <li>è§£è€¦å¤Ÿå½»åº•ï¼Œå¼€å‘è€…åªéœ€è¦ä¿®æ”¹è·¯ç”±é…ç½®è¡¨å°±èƒ½æ— ç¼åœ¨å¤šä¸ªè¯·æ±‚æ¥å£ä¸­çµæ´»åˆ‡æ¢</li> <li>èµ„æºå¤Ÿæ¸…æ™°ï¼Œæ‰€æœ‰çš„å¼€å‘èµ„æºéƒ½èƒ½åˆ°ç²¾ç¡®å¯æ§ï¼ŒåŒæ—¶æ”¯æŒä¸€é”®æ‰“åŒ…æ„å»ºï¼Œå•é¡µå’Œå¤šé¡µæ¨¡å¼å¯å¹¶å­˜</li> <li>é…ç½®å¤Ÿçµæ´»ï¼Œå¯ä»¥æ ¹æ®è‡ªèº«é¡¹ç›®çš„å®é™…æƒ…å†µçµæ´»æ·»åŠ å„ç±»ä¸­é—´ä»¶ï¼Œæ‰©å±•æ¨¡å—å’Œç¬¬ä¸‰æ–¹æ’ä»¶</li></ul> <p><strong>ä¸å¾—ä¸æçš„webpack-dev-server</strong></p> <p>webpackæœ¬èº«çš„å®šä½æ˜¯ä¸€ä¸ªèµ„æºç®¡ç†å’Œæ‰“åŒ…æ„å»ºå·¥ä½œï¼Œæœ¬èº«çš„å¼ºå¤§ä¹‹å¤„åœ¨äºå¯¹å„ç§é™æ€èµ„æºçš„ä¾èµ–åˆ†æå’Œé¢„ç¼–è¯‘ï¼Œåœ¨å®é™…å¼€å‘ä¸­å®˜æ–¹è¿˜æ¨èäº†ä¸€ä¸ªå¿«é€Ÿè¯»å–webpacké…ç½®çš„serverç¯å¢ƒwebpack-dev-serverï¼Œå®˜æ–¹çš„ä»‹ç»æ˜¯ï¼šâ€Use webpack with a development server that provides live reloading. The webpack-dev-server is a little Node.js Express server, which uses the webpack-dev-middleware to serve a webpack bundle. It also has a little runtime which is connected to the server via Sock.js.â€ï¼Œä¸€ä¸ªé€‚ç”¨äºå¼€å‘ç¯å¢ƒçš„ï¼ŒåŸºäºexpress + webpack-dev-middlewareå®ç°çš„ï¼Œæ”¯æŒå®æ—¶æ›´æ–°ï¼Œå†…å­˜æ„å»ºèµ„æºçš„å¼€å‘æœåŠ¡å™¨ï¼Œé€šè¿‡ç®€å•çš„é…ç½®å³å¯æ»¡è¶³webpackå¼€å‘ç¯å¢ƒä¸­çš„ä¸€ç³»åˆ—éœ€æ±‚ï¼Œä½†æ˜¯å½“æˆ‘ä»¬çš„å¼€å‘ç¯å¢ƒæ—¥è¶‹å¤æ‚å’Œå¤šæ ·çš„æ—¶å€™ï¼Œä¸ä»…éœ€è¦å¯¹è‡ªå®šä¹‰é…ç½®çš„ç»†èŠ‚çµæ´»å¯æ§ï¼ŒåŒæ—¶éœ€è¦å¯¹è¿›è¡ŒåŠ å…¥å„ç§ç¬¬ä¸‰æ–¹çš„æ’ä»¶è¿›è¡ŒåŠŸèƒ½æ‰©å±•ï¼Œæ‰èƒ½æœ€å¤§ç¨‹åº¦çš„å‘æŒ¥webpackç¯å¢ƒä¸­çš„å¨åŠ›ã€‚</p> <p><strong>æ‰“é€ é¡¹ç›®ä¸“å±çš„å‰ç«¯å¼€å‘ç¯å¢ƒ</strong></p> <p>æœ‰äº†ç†æƒ³ç¯å¢ƒä¸‹çš„çš„è¿°æ±‚ï¼Œä¹Ÿäº†è§£åˆ°äº†webpack-dev-serverçš„å®ç°ç²¾é«“ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¸€æ­¥æ­¥åœ°æ¥æ‰“é€ ä¸“å±è‡ªèº«çš„å¼€å‘ç¯å¢ƒï¼š</p> <p><strong>ä¸€ ã€å€ŸåŠ©nodeå’Œhttp-proxyå®ç°è·¨åŸŸé€šä¿¡</strong></p> <p>å‰åç«¯åˆ†ç¦»å¼€å‘ä¸­ï¼Œæœ¬åœ°å‰ç«¯å¼€å‘è°ƒç”¨æ¥å£ä¼šæœ‰è·¨åŸŸé—®é¢˜ï¼Œä¸€èˆ¬æœ‰ä»¥ä¸‹å‡ ç§è§£å†³æ–¹æ³•ï¼š</p> <ul><li>ç›´æ¥å¯åŠ¨æœåŠ¡ç«¯é¡¹ç›®ï¼Œå†å°†é¡¹ç›®ä¸­çš„èµ„æºurlæŒ‡å‘åˆ°å‰ç«¯æœåŠ¡ä¸­çš„é™æ€èµ„æºåœ°å€ï¼Œå¥½å¤„åœ¨äºå› ä¸ºå§‹ç»ˆåœ¨æœåŠ¡ç«¯çš„ç¯å¢ƒä¸­è¿›è¡Œèµ„æºè°ƒè¯•ï¼Œä¸å­˜åœ¨æ¥å£çš„è·¨åŸŸè®¿é—®é—®é¢˜ï¼Œä½†æ˜¯ç¼ºé™·ä¹Ÿæ¯”è¾ƒæ˜æ˜¾ï¼Œéœ€è¦åŒæ—¶å¯åŠ¨ä¸¤å¥—ç¯å¢ƒï¼Œè¿˜éœ€è¦å€ŸåŠ©nginxï¼Œcharlesç­‰å·¥å…·è¿›è¡Œèµ„æºåœ°å€çš„ä»£ç†è½¬å‘ï¼Œé…ç½®æ¯”è¾ƒç¹çï¼Œå¯¹å¼€å‘è€…å¯¹ç½‘ç»œçš„ç†è§£å’Œç¯å¢ƒé…ç½®è¦æ±‚è¾ƒé«˜ï¼Œèµ„æºå¼€é”€ä¹Ÿå¤§ï¼›</li> <li>CORSè·¨åŸŸï¼šåç«¯æ¥å£åœ¨è¿”å›çš„æ—¶å€™ï¼Œåœ¨headerä¸­åŠ å…¥â€™Access-Control-Allow-originâ€™ğŸ˜— ç­‰é…ç½®ï¼Œåˆ©ç”¨è·¨åŸŸèµ„æºå…±äº«å®ç°è·¨åŸŸï¼Œå‰ç«¯éƒ¨åˆ†åªè¦æ±‚æ”¯æŒxhr2æ ‡å‡†çš„æµè§ˆå™¨ï¼Œä½†æ˜¯æœåŠ¡ç«¯åœ¨è¯·æ±‚å¤´ä¸­éœ€è¦åœ¨headerä¸­åšå“åº”å¤´é…ç½®ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šè¿˜æ˜¯å¯¹æœåŠ¡ç«¯çš„æ¥å£è®¾ç½®æœ‰ä¸€å®šçš„ä¾èµ–ï¼›</li> <li>http-proxyï¼šç”¨nodejsæ­å»ºæœ¬åœ°httpæœåŠ¡å™¨ï¼Œå¹¶ä¸”åˆ¤æ–­è®¿é—®æ¥å£URLæ—¶è¿›è¡Œè½¬å‘ï¼Œç”±äºåˆ©ç”¨äº†http-proxyæ­£å‘ä»£ç†çš„æ¨¡å¼è¿›è¡Œäº†è½¬å‘ï¼Œé‡‡ç”¨çš„æ˜¯æœåŠ¡å¯¹æœåŠ¡çš„æ¨¡å¼ï¼Œèƒ½è¾ƒä¸ºå®Œç¾è§£å†³æœ¬åœ°å¼€å‘æ—¶å€™çš„è·¨åŸŸé—®é¢˜ï¼Œä¹Ÿæ˜¯æœ¬æ–‡ä¸­æ¨èçš„æ–¹å¼ï¼Œé…ç½®å¦‚ä¸‹ï¼š</li></ul> <p>1ã€æ­å»ºnodeå’Œhttp-proxyç¯å¢ƒ</p> <blockquote><p>npm install express # expressä½œä¸ºnodeåŸºç¡€æœåŠ¡æ¡†æ¶</p> <p>npm install http-proxy-middleware # http-proxyçš„expressä¸­é—´ä»¶</p> <p>npm install body-parser # bodyParserä¸­é—´ä»¶ç”¨æ¥è§£æhttpè¯·æ±‚ä½“</p> <p>npm install querystring    # querystringç”¨æ¥å­—ç¬¦ä¸²åŒ–å¯¹è±¡æˆ–è§£æå­—ç¬¦ä¸²</p></blockquote> <p>å·¥ç¨‹é¡¹ç›®ä¸‹å¯ä»¥æ–°å»ºä¸€ä¸ªserverçš„æ–‡ä»¶å¤¹æ”¾ç½®nodeèµ„æºï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š &gt; server</p> <p>â”œâ”€â”€ main.js â”œâ”€â”€ proxy.config.js â”œâ”€â”€ routes â””â”€â”€ views</p> <p>2ã€ç¼–å†™ä»£ç†é…ç½®è„šæœ¬ï¼š</p> <p>proxy.config.jsä¸­å¯ä»¥é…ç½®å¯¹åº”éœ€è¦ä»£ç†çš„urlå’Œç›®æ ‡urlï¼Œå¦‚ä¸‹ï¼š</p> <blockquote><p>const proxy = [</p> <p>{</p> <p>â€‹    url: '/back_end/auth/*',</p> <p>â€‹    target: 'http://10.2.0.1:8351'</p> <p>},</p> <p>{</p> <p>â€‹    url: '/back_end/*',</p> <p>â€‹    target: 'http://10.2.0.1:8352'</p> <p>}</p> <p>];</p> <p>module.exports = proxy;</p></blockquote> <p>main.jsä¸­çš„é…ç½®å¦‚ä¸‹ï¼š</p> <blockquote><p>const express = require('express')</p> <p>const bodyParser = require('body-parser')</p> <p>const proxy = require('http-proxy-middleware')</p> <p>const querystring = require('querystring')</p> <p>const app = express()</p> <p>// make http proxy middleware setting</p> <p>const createProxySetting = function (url) {</p> <p>return {</p> <p>â€‹    target: url,</p> <p>â€‹    changeOrigin: true,</p> <p>â€‹    headers: {</p> <p>â€‹      Accept: 'application/json',</p> <p>â€‹      'X-Requested-With': 'XMLHttpRequest'</p> <p>â€‹    },</p> <p>â€‹    onProxyReq: function (proxyReq, req) {</p> <p>â€‹      if (req.method === 'POST' &amp;&amp; req.body) {</p> <p>â€‹        const bodyData = querystring.stringify(req.body)</p> <p>â€‹        proxyReq.write(bodyData)</p> <p>â€‹      }</p> <p>â€‹    }</p> <p>}</p> <p>}</p> <p>// parse application/json</p> <p>app.use(bodyParser.json())</p> <p>// parse application/x-www-form-urlencoded</p> <p>app.use(bodyParser.urlencoded({ extended: false }))</p> <p>// proxy</p> <p>proxyConfig.forEach(function (item) {</p> <p>app.use(item.url, proxy(createProxySetting(item.target)))</p> <p>})</p> <p>// eg: http://127.0.0.1:3000/back_end/oppor =&gt; http://10.2.0.1:8352/back_end/oppor</p></blockquote> <p>é€šè¿‡ä»¥ä¸Šçš„é…ç½®æˆ‘ä»¬å°±èƒ½è½»æ¾å°†æŒ‡å®šurlä¸‹çš„è¯·æ±‚è‡ªåŠ¨è½¬å‘åˆ°åŒ¹é…æˆåŠŸçš„ç›®æ ‡æ¥å£ä¸‹ã€‚</p> <p>NODE_ENV=development node ./bin/dev-server.js</p> <p>isDebug: true [HPM] Proxy created: / -&gt; http://10.2.0.1:8351 [HPM] Proxy created: / -&gt; http://10.2.0.1:8352 Listening at 192.168.1.104:3000</p> <p>webpack built d558389f7a9a453af17f in 2018ms Hash: d558389f7a9a453af17f Version: webpack 1.14.0 Time: 2018ms</p> <p><strong>äºŒã€å°†webpacké…ç½®å’Œnode serverè¿›ç¨‹æ‰“é€š</strong></p> <p>1ã€è§£è€¦webpackä¸­çš„é…ç½®</p> <p>ç”±äºwebpackåœ¨å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒä¸­ç»å¸¸éœ€è¦åšå„ç§é…ç½®çš„åˆ‡æ¢ï¼Œå®˜æ–¹ä¹Ÿæä¾›äº†DefinePluginæ¥è¿›è¡Œç¯å¢ƒå‚æ•°è®¾ç½®ï¼Œä½†æ˜¯å¤§é‡çš„åˆ¤æ–­è¯­å¥ä¾µå…¥webpack.configä¸­å…¶å®ä¼šå¯¼è‡´ä»£ç çš„å¯è¯»æ€§å’Œå¤ç”¨æ€§å˜å·®ï¼Œä¹Ÿå®¹æ˜“é€ æˆä»£ç å†—ä½™ï¼Œæˆ‘ä»¬åœ¨æ­¤å¯ä»¥å¯¹é…ç½®æ–‡ä»¶è¿›è¡Œé‡æ„ï¼Œå°†ä¹‹å‰çš„webpacké…ç½®æ–‡ä»¶æ‹†è§£æˆäº†webpack.config.jsï¼Œproject.config.jså’Œenvironments.config.jsä¸‰ä¸ªæ–‡ä»¶ï¼Œä¸‰ä¸ªæ–‡ä»¶å„å¸å…¶èŒï¼Œåˆå¯äº’ç›¸åä½œï¼Œå‡å°‘ç»´æŠ¤æˆæœ¬ï¼Œå¦‚ä¸‹ï¼š</p> <ul><li>environments.config.js: ä¸»è¦çš„ä½œç”¨å°±æ˜¯å­˜æ”¾åœ¨ç‰¹å®šç¯å¢ƒä¸‹çš„éœ€è¦å˜åŒ–çš„é…ç½®å‚æ•°ï¼ŒåŒ…å«æœ‰ï¼špublicpath, devtools, waningsï¼Œhashç­‰</li> <li>project.config.jsï¼šä¸»è¦çš„ä½œç”¨æ˜¯å­˜æ”¾äºé¡¹ç›®æœ‰å…³çš„åŸºç¡€é…ç½®ï¼Œå¦‚ï¼šserverï¼Œoutputï¼Œloaderï¼Œexternalsï¼Œpluginç­‰åŸºç¡€é…ç½®ï¼›é€šè¿‡ä¸€ä¸ªoverrideså®ç°å¯¹environmentsä¸­çš„é…ç½®ä¿¡æ¯é‡è½½ã€‚</li> <li>webpack.config.jsï¼šä¸»è¦æ˜¯è¯»å–project.config.jsä¸­çš„é…ç½®ï¼Œå†æŒ‰æ ‡å‡†çš„webpackå­—æ®µå¡«å…¥projectä¸­çš„é…ç½®ä¿¡æ¯ï¼ŒåŸåˆ™ä¸Šæ˜¯è¯¥æ–‡ä»¶çš„ä¿¡æ¯åªä¸æ„å»ºå·¥å…·æœ‰å…³ï¼Œè€Œä¸å…·ä½“çš„é¡¹ç›®å·¥ç¨‹æ— å…³ï¼Œå¯ä»¥åšåˆ°è·¨é¡¹ç›®é—´å¤ç”¨ã€‚</li></ul> <p>&gt; config â”œâ”€â”€ environments.config.js â”œâ”€â”€ project.config.js â””â”€â”€ webpack.config.js</p> <p>environments.config.jsä¸­çš„å…³é”®å®ç°ï¼š</p> <blockquote><p>// Here is where you can define configuration overrides based on the execution environment.</p> <p>// Supply a key to the default export matching the NODE_ENV that you wish to target, and</p> <p>// the base configuration will apply your overrides before exporting itself.</p> <p>module.exports = {</p> <p>// ======================================================</p> <p>// Overrides when NODE_ENV === 'development'</p> <p>// ======================================================</p> <p>development : (config) =&gt; ({</p> <p>â€‹    compiler_public_path : <code>http://${config.server_host}:${config.server_port}/</code></p> <p>}),</p> <p>// ======================================================</p> <p>// Overrides when NODE_ENV === 'production'</p> <p>// ======================================================</p> <p>production : (config) =&gt; ({</p> <p>â€‹    compiler_base_route      : '/apps/',</p> <p>â€‹    compiler_public_path     : '/static/',</p> <p>â€‹    compiler_fail_on_warning : false,</p> <p>â€‹    compiler_hash_type       : 'chunkhash',</p> <p>â€‹    compiler_devtool         : false,</p> <p>â€‹    compiler_stats           : {</p> <p>â€‹      chunks       : true,</p> <p>â€‹      chunkModules : true,</p> <p>â€‹      colors       : true</p> <p>â€‹    }</p> <p>})</p> <p>}</p></blockquote> <p>project.config.jsä¸­çš„å…³é”®å®ç°ï¼š</p> <blockquote><p>// project.config.js</p> <p>const config = {</p> <p>env : process.env.NODE_ENV || 'development',</p> <p>// ----------------------------------</p> <p>// Project Structure</p> <p>// ----------------------------------</p> <p>path_base  : path.resolve(__dirname, '..'),</p> <p>dir_client : 'src',</p> <p>dir_dist   : 'dist',</p> <p>dir_public : 'public',</p> <p>dir_server : 'server',</p> <p>dir_test   : 'tests',</p> <p>// ----------------------------------</p> <p>// Server Configuration</p> <p>// ----------------------------------</p> <p>server_host : ip.address(), // use string 'localhost' to prevent exposure on local network</p> <p>server_port : process.env.PORT || 3000,</p> <p>// ----------------------------------</p> <p>// Compiler Configuration</p> <p>// ----------------------------------</p> <p>compiler_devtool         : 'source-map',</p> <p>compiler_hash_type       : 'hash',</p> <p>compiler_fail_on_warning : false,</p> <p>compiler_quiet           : false,</p> <p>compiler_public_path     : '/',</p> <p>compiler_stats           : {</p> <p>â€‹    chunks : false,</p> <p>â€‹    chunkModules : false,</p> <p>â€‹    colors : true</p> <p>}</p> <p>};</p> <p>// åœ¨æ­¤é€šè¿‡è¯»å–ç¯å¢ƒå˜é‡è¯»å–environmentsä¸­å¯¹åº”çš„é…ç½®é¡¹ï¼Œå¯¹å‰é¢çš„é…ç½®é¡¹è¿›è¡Œè¦†ç›–</p> <p>const environments = require('./environments.config')</p> <p>const overrides = environments[config.env]</p> <p>if (overrides) {</p> <p>debug('Found overrides, applying to default configuration.')</p> <p>Object.assign(config, overrides(config))</p> <p>} else {</p> <p>debug('No environment overrides found, defaults will be used.')</p> <p>}</p> <p>module.exports = config</p></blockquote> <p>webpack.config.jsä¸­çš„å…³é”®å®ç°ï¼š</p> <blockquote><p>const webpack = require('webpack')</p> <p>const project = require('./project.config')</p> <p>const debug = require('debug')('app:config:webpack')</p> <p>const UglifyJsParallelPlugin = require('webpack-uglify-parallel')</p> <p>const <strong>DEV</strong> = project.globals.<strong>DEV</strong></p> <p>const <strong>PROD</strong> = project.globals.<strong>PROD</strong></p> <p>const webpackConfig = {</p> <p>name    : 'client',</p> <p>target  : 'web',</p> <p>devtool : project.compiler_devtool,</p> <p>resolve : {</p> <p>â€‹    modules: [project.paths.client(), 'node_modules'],</p> <p>â€‹    extensions: ['.web.js', '.js', '.jsx', '.json']</p> <p>},</p> <p>module : {}</p> <p>}</p> <p>if (<strong>DEV</strong>) {</p> <p>debug('Enabling plugins for live development (HMR, NoErrors).')</p> <p>webpackConfig.plugins.push(</p> <p>â€‹      new webpack.HotModuleReplacementPlugin()</p> <p>)</p> <p>} else if (<strong>PROD</strong>) {</p> <p>debug('Enabling plugins for production (UglifyJS).')</p> <p>webpackConfig.plugins.push(</p> <p>â€‹    new webpack.optimize.OccurrenceOrderPlugin(),</p> <p>â€‹    new webpack.optimize.DedupePlugin(),</p> <p>â€‹    new UglifyJsParallelPlugin({</p> <p>â€‹      workers: os.cpus().length,</p> <p>â€‹      mangle: true,</p> <p>â€‹      compressor: {</p> <p>â€‹        warnings: false,</p> <p>â€‹        drop_debugger: true,</p> <p>â€‹        dead_code: true</p> <p>â€‹      }</p> <p>â€‹    })</p> <p>)</p> <p>}</p></blockquote> <p>ç”±æ­¤å¯çŸ¥ï¼Œä¸‰è€…é—´çš„æ³¨å…¥å…³ç³»å¦‚ä¸‹ï¼š</p> <p>&gt; environments -&gt; project -&gt; webpack</p> <p>2ã€æ•´åˆwebpackåœ¨å¼€å‘ç¯å¢ƒä¸­ä¾èµ–çš„ä¸­é—´ä»¶</p> <p>å‚è€ƒwebapck-dev-serverä¸­çš„å®ç°ï¼Œæˆ‘ä»¬å¯ä»¥å°†webpack-dev-middlewareå’Œwebpack-hot-middlewareåŠ å…¥åˆ°æˆ‘ä»¬çš„expressé…ç½®ä¸­ï¼Œ</p> <blockquote><p>npm install webpack-dev-middleware</p> <p>npm install webpack-hot-middleware</p></blockquote> <p>å…·ä½“é…ç½®å¦‚ä¸‹ï¼š</p> <blockquote><p>const express = require('express')</p> <p>const debug = require('debug')('app:server')</p> <p>const webpack = require('webpack')</p> <p>const webpackConfig = require('../config/webpack.config')</p> <p>const project = require('../config/project.config')</p> <p>const app = express()</p> <p>// ------------------------------------</p> <p>// Apply Webpack HMR Middleware</p> <p>// ------------------------------------</p> <p>if (project.env === 'development') {</p> <p>const compiler = webpack(webpackConfig)</p> <p>debug('Enabling webpack dev and HMR middleware')</p> <p>app.use(require('webpack-dev-middleware')(compiler, {</p> <p>â€‹    publicPath  : webpackConfig.output.publicPath,</p> <p>â€‹    contentBase : project.paths.client(),</p> <p>â€‹    hot         : true,</p> <p>â€‹    quiet       : project.compiler_quiet,</p> <p>â€‹    noInfo      : project.compiler_quiet,</p> <p>â€‹    lazy        : false,</p> <p>â€‹    stats       : project.compiler_stats</p> <p>}))</p> <p>// webpack_hmr</p> <p>app.use(require('webpack-hot-middleware')(compiler, {</p> <p>â€‹    path: '/__webpack_hmr'</p> <p>}))</p> <p>// proxy</p> <p>.......</p> <p>}</p> <p>module.exports = app.listen(project.server_port, function (err) {</p> <p>if (err) {</p> <p>â€‹    console.log(err)</p> <p>â€‹    return</p> <p>}</p> <p>var uri = project.server_host + ':' + project.server_port</p> <p>console.log('Listening at ' + uri + 'n')</p> <p>});</p></blockquote> <p>è¿™æ ·å½“æˆ‘ä»¬æ‰§è¡Œä¸‹è¿°çš„æ—¶å€™ï¼Œå°±èƒ½ä¸€é”®å®ŒæˆwebpackåŸºç¡€é…ç½®ï¼Œçƒ­æ›´æ–°ä»¥åŠepxressæœåŠ¡çš„å¯åŠ¨ï¼Œå¹¶ä¸”å¯ä»¥å®Œå…¨æ ¹æ®expressçš„é…ç½®è¯´æ˜æ¥è‡ªå®šä¹‰æ‰©å±•æˆ‘ä»¬çš„å‰ç«¯å¼€å‘èµ„æºã€‚</p> <blockquote><p>ENV=development node ./bin/dev-server.js</p></blockquote> <p><strong>ä¸‰ã€å‰ç«¯èµ„æºè·¯å¾„è®¾è®¡</strong></p> <p>å®é™…å¼€å‘ä¸­ï¼Œæ‰€æœ‰æ¶‰åŠåˆ°çš„å‰ç«¯èµ„æºæˆ‘ä»¬è¿›è¡Œå½’ç±»ä¸€èˆ¬ä¼šæœ‰å¦‚ä¸‹å‡ ç§ï¼š</p> <ul><li>htmlï¼šhtmlé¡µé¢ï¼Œç»“åˆåˆ°æœåŠ¡åä¸€èˆ¬ç§°ä¸ºæ¨¡æ¿èµ„æºï¼Œæ˜¯æ‰€æœ‰èµ„æºçš„å…¥å£å’Œç»“æœå‘ˆç°é¡µï¼›</li> <li>jsï¼šjavascriptæ‰§è¡Œè„šæœ¬èµ„æºï¼ŒåŸºäºç°ä»£Javascriptæ¡†æ¶å¼€å‘åé€šå¸¸è¿˜éœ€è¦å€ŸåŠ©babelï¼Œtypescriptç­‰è¿›è¡Œç¼–è¯‘å¤„ç†ï¼Œåˆ†ä¸ºbuildå‰åbuildåä¸¤å¥—ä»£ç ï¼›</li> <li>cssï¼šæ ·å¼èµ„æºï¼Œå¦‚æœé‡‡ç”¨äº†lessï¼Œsassç­‰å·¥å…·å¤„ç†åä¼šä¹Ÿä¼šä».lesså’Œ.sassç¼–è¯‘æˆ.cssæ–‡ä»¶;</li> <li>static: é™æ€èµ„æºï¼Œé€šå¸¸ä¼šåŒ…å«æœ‰fontï¼Œimageï¼Œaudioï¼Œvideoç­‰é™æ€æ–‡ä»¶ï¼Œç»“åˆåˆ°æœåŠ¡æ¡†æ¶ä¸­ä¸€èˆ¬éœ€è¦è®¾å®šç‰¹å®šçš„è®¿é—®è·¯å¾„ï¼Œç›´æ¥è¯»å–æ–‡ä»¶åŠ è½½ã€‚</li> <li>åœ¨wepbackçš„é…ç½®ä¸­ï¼Œå‰ç«¯èµ„æºè·¯å¾„æˆ‘ä»¬é€šå¸¸æ˜¯å€ŸåŠ©pathå’ŒpublicPath å¯¹æ„å»ºå‡ºæ¥çš„å‰ç«¯èµ„æºè¿›è¡Œç´¢å¼•ï¼Œç”±äºwebpacké‡‡ç”¨äº†åŸºäºå†…å­˜æ„å»ºçš„æ–¹å¼ï¼Œpathé€šå¸¸ç”¨æ¥ç”¨æ¥å­˜æ”¾æ‰“åŒ…åæ–‡ä»¶çš„è¾“å‡ºç›®å½•ï¼ŒpublicPathåˆ™ç”¨æ¥æŒ‡å®šèµ„æºæ–‡ä»¶å¼•ç”¨çš„è™šæ‹Ÿç›®å½•ï¼Œå…·ä½“ç¤ºä¾‹å¦‚ä¸‹ï¼š</li></ul> <blockquote><p>module.exports = {</p> <p>entry: path.join(__dirname,&quot;src&quot;,&quot;entry.js&quot;),</p> <p>output: {</p> <p>â€‹    /*</p> <p>â€‹        webpack-dev-serverç¯å¢ƒä¸‹ï¼Œpathã€publicPathã€--content-base åŒºåˆ«ä¸è”ç³»</p> <p>â€‹        pathï¼šæŒ‡å®šç¼–è¯‘ç›®å½•è€Œå·²ï¼ˆ/build/js/ï¼‰ï¼Œä¸èƒ½ç”¨äºhtmlä¸­çš„jså¼•ç”¨ã€‚</p> <p>â€‹        publicPathï¼šè™šæ‹Ÿç›®å½•ï¼Œè‡ªåŠ¨æŒ‡å‘pathç¼–è¯‘ç›®å½•ï¼ˆ/assets/ =&gt; /build/js/ï¼‰ã€‚htmlä¸­å¼•ç”¨jsæ–‡ä»¶æ—¶ï¼Œå¿…é¡»å¼•ç”¨æ­¤è™šæ‹Ÿè·¯å¾„ï¼ˆä½†å®é™…ä¸Šå¼•ç”¨çš„æ˜¯å†…å­˜ä¸­çš„æ–‡ä»¶ï¼Œæ—¢ä¸æ˜¯/build/js/ä¹Ÿä¸æ˜¯/assets/ï¼‰ã€‚</p> <p>â€‹        --content-baseï¼šå¿…é¡»æŒ‡å‘åº”ç”¨æ ¹ç›®å½•ï¼ˆå³index.htmlæ‰€åœ¨ç›®å½•ï¼‰ï¼Œä¸ä¸Šé¢ä¸¤ä¸ªé…ç½®é¡¹æ¯«æ— å…³è”ã€‚</p> <p>â€‹        ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</p> <p>â€‹        å‘å¸ƒè‡³ç”Ÿäº§ç¯å¢ƒï¼š</p> <p>â€‹        1.webpackè¿›è¡Œç¼–è¯‘ï¼ˆå½“ç„¶æ˜¯ç¼–è¯‘åˆ°/build/js/ï¼‰</p> <p>â€‹        2.æŠŠç¼–è¯‘ç›®å½•ï¼ˆ/build/js/ï¼‰ä¸‹çš„æ–‡ä»¶ï¼Œå…¨éƒ¨å¤åˆ¶åˆ°/assets/ç›®å½•ä¸‹ï¼ˆæ³¨æ„ï¼šä¸æ˜¯å»ä¿®æ”¹index.htmlä¸­å¼•ç”¨bundle.jsçš„è·¯å¾„ï¼‰</p> <p>â€‹    */</p> <p>â€‹    path: path.join(__dirname,&quot;build&quot;,&quot;js&quot;),</p> <p>â€‹    publicPath: &quot;/assets/&quot;,</p> <p>â€‹    //publicPath: &quot;http://cdn.com/assets/&quot;,//ä½ ä¹Ÿå¯ä»¥åŠ ä¸Šå®Œæ•´çš„urlï¼Œæ•ˆæœä¸ä¸Šé¢ä¸€è‡´ï¼ˆä¸éœ€è¦ä¿®æ”¹index.htmlä¸­å¼•ç”¨bundle.jsçš„è·¯å¾„ï¼Œä½†å‘å¸ƒç”Ÿäº§ç¯å¢ƒæ—¶ï¼Œéœ€è¦ä½¿ç”¨æ’ä»¶æ‰èƒ½æ‰¹é‡ä¿®æ”¹å¼•ç”¨åœ°å€ä¸ºcdnåœ°å€ï¼‰ã€‚</p> <p>â€‹    filename: 'bundle.js'</p> <p>}</p> <p>};</p></blockquote> <p>æœ‰äº†å¦‚ä¸Šçš„æ¦‚å¿µï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†pathï¼Œpublicpathå’Œexpressä¸­çš„é…ç½®ç»“åˆèµ·æ¥ï¼ŒåŒæ—¶ç”±äºåœ¨å¼€å‘ç¯å¢ƒä¸­æˆ‘ä»¬çš„èµ„æºå…¥å£é€šå¸¸åˆä¼šæŒ‰ç‰¹å®šçš„ç›®å½•æ¥è¿›è¡Œæ–‡ä»¶å­˜æ”¾ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p> <p>&gt; project</p> <p>â”œâ”€â”€ LICENSE â”œâ”€â”€ README.md â”œâ”€â”€ app.json â”œâ”€â”€ dist â”œâ”€â”€ bin â”œâ”€â”€ config â”œâ”€â”€ package.json â”œâ”€â”€ postcss.config.js â”œâ”€â”€ public â”œâ”€â”€ server â”œâ”€â”€ src â””â”€â”€ yarn.lock</p> <p>ä»ä¸­ä¸éš¾å‘ç°node serverä¸­éœ€è¦é…ç½®çš„èµ„æºç›®å½•å¾€å¾€ä¼šå’Œwebpackçš„å·¥ç¨‹ç›®å½•é‡å ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦åœ¨expressä¸­è¿›è¡Œç›¸åº”çš„é…ç½®ï¼Œæ‰èƒ½å®ç°èµ„æºçš„æ­£ç¡®ç´¢å¼•ã€‚</p> <p>1ã€htmlæ¨¡æ¿èµ„æºè¯»å–</p> <p>htmlä½œä¸ºwebpackä¸­çš„templatesï¼Œåœ¨expressä¸­åˆ™ä¼šå˜æˆviewsï¼Œè¯»å–æ–¹å¼ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹èµ„æºè¿›è¡Œå¦‚ä¸‹é…ç½®ï¼š</p> <blockquote><p>npm install ejs  #è®©expressæ”¯æŒhtmlæ¨¡æ¿æ ¼å¼</p></blockquote> <blockquote><p>const ejs = require('ejs')</p> <p>const app = express()</p> <p>// view engine, é»˜è®¤å¯ä»¥æŒ‡å‘dist</p> <p>app.set('views', project.paths.dist())</p> <p>app.engine('.html', ejs.__express)</p> <p>app.set('view engine', 'html')</p> <p>// é€šè¿‡é…ç½®è®©expressè¯»å–webpackçš„å†…å­˜æ‰“åŒ…èµ„æºä¸‹çš„templateæ–‡ä»¶</p> <p>app.use('/home', function (req, res, next) {</p> <p>const filename = path.join(compiler.outputPath, 'index.html'')</p> <p>compiler.outputFileSystem.readFile(filename, (err, result) =&gt; {</p> <p>â€‹    if (err) {</p> <p>â€‹     return next(err)</p> <p>â€‹    }</p> <p>res.set('content-type', 'text/html')</p> <p>â€‹     res.send(result)</p> <p>â€‹     res.end()</p> <p>})</p> <p>})</p> <p>//è®©expressæ‰€æœ‰çš„è·¯ç”±è¯·æ±‚éƒ½è½åˆ°index.htmlä¸­ï¼Œå†æœ‰å‰ç«¯æ¡†æ¶ä¸­çš„å‰ç«¯è·¯ç”±æ¥ç®¡é¡µé¢çš„è·³è½¬</p> <p>app.use('*', function (req, res, next) {</p> <p>â€‹    const filename = path.join(compiler.outputPath, 'index.html')</p> <p>â€‹    compiler.outputFileSystem.readFile(filename, (err, result) =&gt; {</p> <p>â€‹      if (err) {</p> <p>â€‹        return next(err)</p> <p>â€‹      }</p> <p>â€‹      res.set('content-type', 'text/html')</p> <p>â€‹      res.send(result)</p> <p>â€‹      res.end()</p> <p>â€‹    })</p> <p>â€‹    /<em>ä¹Ÿå¯ä»¥æŒ‡å®šåˆ°ç‰¹å®šçš„viewsæ–‡ä»¶ä¸‹è¿›è¡Œæ¨¡æ¿èµ„æºè¯»å–</em>/</p> <p>â€‹     res.render('home.html', {</p> <p>â€‹       name:'home.html'</p> <p>â€‹     })</p> <p>})</p></blockquote> <p>2ã€jså’Œcssèµ„æºè¯»å– jså’Œcssçš„å¼•ç”¨åœ°å€åœ¨webpackçš„å¼€å‘ç¯å¢ƒä¸­é€šå¸¸ä¼šæŒ‡å‘publicpathï¼Œæ‰€ä»¥åœ¨å¼€å‘é¡µé¢ä¸­ä¼šç›´æ¥å¦‚ä¸‹åµŒå…¥å¦‚ä¸‹åœ°å€ï¼Œç”±äºæ˜¯é‡‡ç”¨ç»å¯¹åœ°å€æŒ‡å‘ï¼Œæ‰€ä»¥æ— éœ€åšä»»ä½•é…ç½®ï¼š</p> <blockquote><link rel="stylesheet" href="http://127.0.0.1:3000/css/app.qxdfa323434adfc23314.css"><script src="http://127.0.0.1:3000/js/app.ab92c02d96a1a7cd4919.js"></script></blockquote> <p>3ã€é™æ€èµ„æºè¯»å– å…¶ä»–ç±»ä¼¼fontï¼Œimagesç­‰é™æ€è¯»å–ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸€ä¸ªå›¾ç‰‡æ”¾åˆ°å·¥ç¨‹ç»“æ„ä¸­çš„publicä¸‹ï¼Œåˆ™è®¿é—®åœ°å€å¯ä»¥æŒ‰å¦‚ä¸‹ä¹¦å†™ï¼Œæ”¯æŒçœŸå®è·¯å¾„å’Œè™šæ‹Ÿè·¯å¾„ï¼š</p> <blockquote><p>// çœŸå®è·¯å¾„ï¼Œæ ¹ç›®å½•è®¿é—®ï¼š/demo.png -&gt; /pulbic/demo.png</p> <p>app.use(express.static(project.paths.public()))</p> <p>// çœŸå®è·¯å¾„ï¼Œå­ç›®å½•è®¿é—®ï¼š/static/demo.png -&gt; /pulbic/static/demo.png</p> <p>app.use(express.static(project.paths.public()))</p> <p>// è™šæ‹Ÿè·¯å¾„ï¼Œè·Ÿç›®å½•è®¿é—®ï¼š/static/demo.png -&gt; /pulbic/demo.png</p> <p>app.use('/static/', express.static(project.paths.public()))</p> <p>// è™šæ‹Ÿè·¯å¾„ï¼Œå­ç›®å½•è®¿é—®ï¼š/static/img/demo.png -&gt; /pulbic/img/demo.png</p> <p>app.use('/static/', express.static(project.paths.public()))</p></blockquote> <p>é€šè¿‡ä»¥ä¸Šé…ç½®ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨è®¿é—®å¼€å‘åœ°å€( eg: localhost:3000 )æ—¶å³å¯å¾—åˆ°æ‰€éœ€çš„å…¨éƒ¨å‰ç«¯èµ„æºã€‚</p> <p><strong>å››ã€mockæ•°æ®æ¨¡æ‹Ÿ</strong></p> <p>ä½œä¸ºå‰ç«¯ç»å¸¸éœ€è¦æ¨¡æ‹Ÿåå°æ•°æ®ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºmockã€‚é€šå¸¸çš„æ–¹å¼ä¸ºè‡ªå·±æ­å»ºä¸€ä¸ªæœåŠ¡å™¨ï¼Œè¿”å›æˆ‘ä»¬æƒ³è¦çš„æ•°æ®ï¼Œæ—¢ç„¶æˆ‘ä»¬å·²ç»å°†expressé›†æˆåˆ°äº†æˆ‘ä»¬çš„å¼€å‘ç¯å¢ƒä¸‹ï¼Œé‚£ä¹ˆå®ç°ä¸€ä¸ªmockå°±ä¼šéå¸¸ç®€å•ï¼Œä»¥ä¸‹ä»‹ç»ä¸¤ç§mockæ•°æ®çš„æ–¹å¼ã€‚</p> <p>1ã€é…ç½®ä¸“å±çš„mockè·¯ç”±æ¨¡å— æˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬çš„serveré¡¹ç›®ä¸‹çš„routesæ¨¡å—ä¸­åŠ å…¥ä¸€ä¸ªmockæ¨¡å—ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š &gt; server â”œâ”€â”€ main.js â”œâ”€â”€ mock â”‚ â”œâ”€â”€ opporList.json â”œâ”€â”€ routes â”‚ â”œâ”€â”€ index.js â”‚ â””â”€â”€ mock.js â””â”€â”€ views â””â”€â”€ home.html</p> <p>ç„¶åå†åœ¨æˆ‘ä»¬çš„serverä¸‹çš„é…ç½®æ–‡ä»¶ä¸­å¯¼å…¥mockæ¨¡å—é…ç½®ï¼š</p> <blockquote><p>// main.js</p> <p>const mock = require('./routes/mock')</p> <p>if (project.env === 'development') {</p> <p>// mock routes</p> <p>app.use('/mock, mock)</p> <p>}</p></blockquote> <p>routesä¸­çš„mock.jsä¸­å†™å…¥å¦‚ä¸‹mockæ•°æ®é…ç½®å³å¯ï¼š</p> <blockquote><p>const express = require('express')</p> <p>const router = express.Router()</p> <p>const opporList = require('../mock/opporList.json');</p> <p>const Mock = require('mockjs');</p> <p>// ç›´æ¥è¯»å–jsonæ–‡ä»¶å¯¼å‡º</p> <p>router.get('/backend/opporList', function (req, res) {</p> <p>res.json(opporList)</p> <p>})</p> <p>// åŸºäºmockjsç”Ÿæˆæ•°æ®, ä¼˜åŠ¿åœ¨äºå¯¹é¡¹ç›®ä»£ç æ— ä¾µå…¥ï¼Œå¹¶ä¸”æ”¯æŒfetchï¼Œxhrç­‰å¤šç§æ–¹å¼çš„æ‹¦æˆª</p> <p>router.get('/backend/employee', function (req, res) {</p> <p>var data = Mock.mock({</p> <p>â€‹    // å±æ€§ list çš„å€¼æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­å«æœ‰ 1 åˆ° 10 ä¸ªå…ƒç´ </p> <p>â€‹    'list|1-10': [{</p> <p>â€‹      // å±æ€§ id æ˜¯ä¸€ä¸ªè‡ªå¢æ•°ï¼Œèµ·å§‹å€¼ä¸º 1ï¼Œæ¯æ¬¡å¢ 1</p> <p>â€‹      'id|+1': 1</p> <p>â€‹    }]</p> <p>})</p> <p>res.json(data)</p> <p>})</p> <p>module.exports = router</p></blockquote> <p>é…ç½®å®Œæˆåï¼Œè®¿é—®å¦‚ä¸‹åœ°å€å³å¯æ‹¿åˆ°mockæ•°æ®ï¼š</p> <ul><li>http://127.0.0.1:3000/mock/backend/opporList</li> <li>http://127.0.0.1:3000/mock/backend/employee</li></ul> <p>å†åˆ©ç”¨æˆ‘ä»¬çš„proxy.configä¿®æ”¹node-proxyé…ç½®ï¼Œå°†æµ‹è¯•è‡ªåŠ¨è½¬åˆ°mockç›®æ ‡åœ°å€ä¸‹ï¼š</p> <blockquote><p>const proxy = [</p> <p>â€‹    {</p> <p>â€‹      url: '/backend/*',</p> <p>â€‹      target: &quot;http://127.0.0.1:3000/mock&quot;</p> <p>â€‹    }</p> <p>]</p> <p>module.exports = proxy</p></blockquote> <p>2ã€æ­å»ºç‹¬ç«‹çš„mockæœåŠ¡ å¦‚æœä¼ä¸šä¸­æœ‰éƒ¨ç½²ç‹¬ç«‹çš„mockæœåŠ¡å™¨ï¼Œå¦‚puer+mockï¼šæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹ç®€å•çš„proxy.configæ¥ç›´æ¥å®ç°éœ€è¦mockçš„è¯·æ±‚åœ°å€è½¬å‘ï¼Œç›¸å¯¹ä¿®æ”¹å°±æ¯”è¾ƒç®€å•ï¼Œå¦‚ä¸‹ï¼š</p> <blockquote><p>const proxy = [</p> <p>â€‹    {</p> <p>â€‹      url: '/backend/*',</p> <p>â€‹      target: &quot;http://10.4.31.11:8080/mock&quot;</p> <p>â€‹    }</p> <p>]</p> <p>module.exports = proxy</p></blockquote> <p><strong>äº”ã€é¢„è§ˆæ‰“åŒ…åçš„èµ„æºæ•ˆæœ</strong></p> <p>å½“æˆ‘ä»¬å¼€å‘å®Œæˆåï¼Œwepbacké€šè¿‡ç¼–è¯‘å¯ä»¥å¾—åˆ°æˆ‘ä»¬éœ€è¦çš„å„ç§é™æ€èµ„æºï¼Œè¿™ç±»æ–‡ä»¶é€šå¸¸æ˜¯ä½œä¸ºé™æ€èµ„æºå­˜åœ¨ï¼Œéœ€è¦æ”¾åˆ°cdnæˆ–è€…éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šæ‰èƒ½è®¿é—®ï¼Œä½†æ˜¯æˆ‘ä»¬é€šè¿‡ç®€å•çš„é…ç½®ä¹Ÿå¯ä»¥ç›´æ¥åœ¨æœ¬åœ°ç¯å¢ƒä¸‹ç›´æ¥é¢„è§ˆæ‰“åŒ…åçš„èµ„æºæ•ˆæœï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</p> <p>\1. æ‰¾åˆ°æ„å»ºèµ„æºç”Ÿæˆç›®å½•, ç¡®è®¤æ„å»ºèµ„æºå·²å­˜åœ¨ï¼š</p> <p>dist â”œâ”€â”€ css â”‚ â”œâ”€â”€ app.5f5af15a.css â”‚ â”œâ”€â”€ login.7cb6ada6.css â”‚ â””â”€â”€ vendors.54895ec1.css â”œâ”€â”€ images â”‚ â”œâ”€â”€ login_bg.8953d181.png â”‚ â”œâ”€â”€ logo.01cf3dce.png â”‚ â””â”€â”€ wap_ico.e4e9be83.png â”œâ”€â”€ index.html â”œâ”€â”€ js â”‚ â”œâ”€â”€ app.eb852be2.js â”‚ â”œâ”€â”€ login.9a049514.js â”‚ â”œâ”€â”€ manifest.c75a01fc.js â”‚ â””â”€â”€ vendors.20a872dc.js â””â”€â”€ login.html</p> <p>\2. ä¿®æ”¹expressçš„æ–‡æœ¬é…ç½®ä¿¡æ¯ï¼ŒåŠ å…¥æ„å»ºå®Œæˆåçš„é™æ€èµ„æºåœ°å€é…ç½®ï¼š</p> <blockquote><p>app.set('views', project.paths.dist())</p> <p>if (project.env === 'development') {</p> <p>....</p> <p>} else {</p> <p>debug(</p> <p>â€‹    'Server is being run outside of live development mode'</p> <p>)</p> <p>// é…ç½®é¢„è§ˆç¯å¢ƒä¸‹çš„proxy.configï¼Œä¸€èˆ¬å¯ä»¥æŒ‡å‘æµ‹è¯•ç¯å¢ƒåœ°å€</p> <p>const proxyConfig = require('./proxy.test.config')</p> <p>const routes = require('./routes')</p> <p>proxyConfig.forEach(function (item) {</p> <p>â€‹    app.use(item.url, proxy(createProxySetting(item.target)))</p> <p>})</p> <p>// ä¿®æ”¹é™æ€èµ„æºæŒ‡å‘åœ°å€ï¼Œå¯ä»¥ç›´æ¥é…ç½®åˆ°distç›®å½•ä¸‹</p> <p>app.use(project.compiler_public_path,express.static(project.paths.dist())</p> <p>// é…ç½®è®¿é—®è·¯ç”±urlï¼Œå¹¶åœ¨è®¾ç½®ç½®çœŸå®çš„templateæ–‡ä»¶åœ°å€ï¼Œä¸webpackä¸­çš„htmlpluginä¸‹çš„filenameé…ç½®è·¯å¾„ä¿æŒä¸€è‡´ï¼Œä¸€èˆ¬éƒ½åœ¨distç›®å½•ä¸‹</p> <p>app.use(project.compiler_base_route, routes)</p> <p>}</p></blockquote> <p>\3. å¯åŠ¨é¢„è§ˆé¡µé¢ï¼Œè®¿é—®:localhost:3000å³å¯</p> <p>NODE_ENV=production node ./bin/dev-server.js</p> <p>å®Œæ•´å·¥ç¨‹ç»“æ„ç›®å½•ç»“æ„å‚è€ƒ</p> <blockquote><p>Project â”œâ”€â”€ LICENSE â”œâ”€â”€ README.md â”œâ”€â”€ app.json â”œâ”€â”€ bin â”‚ â”œâ”€â”€ compile.js â”‚ â””â”€â”€ dev-server.js â”œâ”€â”€ config â”‚ â”œâ”€â”€ environments.config.js â”‚ â”œâ”€â”€ karma.config.js â”‚ â”œâ”€â”€ npm-debug.log â”‚ â”œâ”€â”€ project.config.js â”‚ â””â”€â”€ webpack.config.js â”œâ”€â”€ package.json â”œâ”€â”€ postcss.config.js â”œâ”€â”€ public â”‚ â”œâ”€â”€ favicon.ico â”‚ â”œâ”€â”€ humans.txt â”‚ â””â”€â”€ robots.txt â”œâ”€â”€ server â”‚ â”œâ”€â”€ main.js â”‚ â”œâ”€â”€ proxy.config.js â”‚ â”œâ”€â”€ routes â”‚ â””â”€â”€ views â”œâ”€â”€ src â”‚ â”œâ”€â”€ api â”‚ â”œâ”€â”€ components â”‚ â”œâ”€â”€ containers â”‚ â”œâ”€â”€ index.html â”‚ â”œâ”€â”€ layouts â”‚ â”œâ”€â”€ main.js â”‚ â”œâ”€â”€ routes â”‚ â”œâ”€â”€ static â”‚ â”œâ”€â”€ store â”‚ â””â”€â”€ until â”œâ”€â”€ tests â”‚ â”œâ”€â”€ components â”‚ â”œâ”€â”€ layouts â”‚ â”œâ”€â”€ routes â”‚ â”œâ”€â”€ store â”‚ â””â”€â”€ test-bundler.js â””â”€â”€ yarn.lock</p></blockquote> <p>å·¥ç¨‹æ¼”ç¤ºdemoï¼ˆhttps://github.com/taikongfeizhu/webpack-develop-startkitï¼‰</p> <p><strong>å°ç»“</strong></p> <p>å°†webpackçš„å„ç±»é«˜çº§ç‰¹æ€§å’ŒnodeåŸºç¡€æœåŠ¡æœ‰æ•ˆç›¸ç»“åˆï¼ŒæŒ‰éœ€æ‰“é€ ä¸“å±è‡ªèº«é¡¹ç›®çš„å¼€å‘å¹³å°ï¼Œä¸ä»…èƒ½å°†é¡¹ç›®ä½“ç³»ä»ç®€å•çš„é¡µé¢å¼€å‘è½¬å‘å·¥ç¨‹åŒ–æ ‡å‡†è¿ˆè¿›ï¼Œæ›´èƒ½æå¤§çš„æ”¹å–„å‰ç«¯å¼€å‘çš„ä½“éªŒï¼Œæå‡å¼€å‘æ•ˆç‡ï¼Œæœ‰çº°æ¼çš„åœ°æ–¹ä¹Ÿå¸Œæœ›èƒ½å¤šå¤šæŒ‡æ­£ã€‚</p></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">9/17/2018, 5:48:19 PM</span></div></div> <!----> </div> <!----></div></div>
    <script src="/Blog/assets/js/41.259d1527.js" defer></script><script src="/Blog/assets/js/app.b624378b.js" defer></script>
  </body>
</html>
