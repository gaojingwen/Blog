(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{103:function(t,s,e){"use strict";e.r(s);var n=e(0),r=Object(n.a)({},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),e("ol",[t._m(6),t._v(" "),t._m(7),t._v(" "),e("li",[e("p",[t._v("第三种方式是将取值与判断合并，通过不停的枚举每一项来循环，直到枚举到空值则循环结束。执行顺序是：")]),t._v(" "),e("ul",[t._m(8),t._v(" "),e("li",[e("p",[t._v("第二步：取出数组的第"),e("code",[t._v("i")]),t._v("项"),e("code",[t._v("persons[i]")]),t._v("赋值给变量"),e("code",[t._v("person")]),t._v("并判断是否为"),e("a",{attrs:{href:"https://link.juejin.im/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FGlossary%2FTruthy",target:"_blank",rel:"noopener noreferrer"}},[t._v("Truthy"),e("OutboundLink")],1)])]),t._v(" "),t._m(9),t._v(" "),e("li",[e("p",[t._v("第四步：")]),t._v(" "),t._m(10),e("p",[t._v("。")]),t._v(" "),e("blockquote",[e("p",[t._v("当第二步中"),e("code",[t._v("person")]),t._v("的值不再是"),e("a",{attrs:{href:"https://link.juejin.im/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FGlossary%2FTruthy",target:"_blank",rel:"noopener noreferrer"}},[t._v("Truthy"),e("OutboundLink")],1),t._v("时，循环结束。方法三甚至可以这样写")])]),t._v(" "),t._m(11)])])]),t._v(" "),t._m(12)]),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),e("p",[t._v("然后分别用四种循环方式，把数组中的每一项取出，并添加到一个空数组中，也就是一次数组的浅拷贝。并通过"),e("a",{attrs:{href:"https://link.juejin.im/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FConsole%2Ftime",target:"_blank",rel:"noopener noreferrer"}},[t._v("console.time"),e("OutboundLink")],1),t._v("和"),e("a",{attrs:{href:"https://link.juejin.im/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FConsole%2FtimeEnd",target:"_blank",rel:"noopener noreferrer"}},[t._v("console.timeEnd"),e("OutboundLink")],1),t._v("记录每种循环方式的整体执行时间。通过"),e("a",{attrs:{href:"https://link.juejin.im/?target=http%3A%2F%2Fwww.ruanyifeng.com%2Fblog%2F2017%2F04%2Fmemory-leak.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("process.memoryUsage()"),e("OutboundLink")],1),t._v("比对执行前后内存中已用到的堆的差值。")]),t._v(" "),t._m(16),t._m(17),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),t._v(" "),e("p",[e("code",[t._v("v8引擎")]),t._v("新版本针对"),e("strong",[t._v("对象取值")]),t._v("等操作进行了最大限度的性能优化，所以方法二中缓存数组的长度到变量"),e("code",[t._v("len")]),t._v("中，并不会有太明显的提升。即使是百万级的数据，四种"),e("code",[t._v("for循环")]),t._v("的耗时差距也只是毫秒级，内存占用上四种for循环方式也都非常接近。在此感谢"),e("a",{attrs:{href:"https://link.juejin.im/?target=https%3A%2F%2Fjuejin.im%2Fuser%2F5881e022128fe100682735aa",target:"_blank",rel:"noopener noreferrer"}},[t._v("YaHuiLiang"),e("OutboundLink")],1),t._v("、"),e("a",{attrs:{href:"https://link.juejin.im/?target=https%3A%2F%2Fjuejin.im%2Fuser%2F58bf96c844d90400696b4c9b",target:"_blank",rel:"noopener noreferrer"}},[t._v("七秒先生"),e("OutboundLink")],1),t._v("、"),e("a",{attrs:{href:"https://link.juejin.im/?target=https%3A%2F%2Fjuejin.im%2Fuser%2F5aa5d7fa5188255579184954",target:"_blank",rel:"noopener noreferrer"}},[t._v("戈寻谋doxP"),e("OutboundLink")],1),t._v("、"),e("a",{attrs:{href:"https://link.juejin.im/?target=https%3A%2F%2Fjuejin.im%2Fuser%2F57a1e90c5bbb500064ffc8c0%2Fposts",target:"_blank",rel:"noopener noreferrer"}},[t._v("超级大柱子"),e("OutboundLink")],1),t._v("的帮助和指正，如果大佬们有更好的见解也欢迎评论留言。")]),t._v(" "),t._m(21),t._v(" "),t._m(22),t._v(" "),t._m(23),t._v(" "),t._m(24),t._v(" "),e("p",[t._v("考虑到在不同环境或浏览器下的性能和效率：")]),t._v(" "),e("p",[e("code",[t._v("推荐")]),t._v("："),e("strong",[t._v("第四种")]),e("code",[t._v("i--")]),t._v("倒序循环的方式。在奇舞团的这篇文章——"),e("a",{attrs:{href:"https://link.juejin.im/?target=https%3A%2F%2Fjuejin.im%2Fentry%2F5b4da7efe51d45198f5c6234",target:"_blank",rel:"noopener noreferrer"}},[t._v("嗨，送你一张Web性能优化地图"),e("OutboundLink")],1),t._v("的"),e("code",[t._v("2.3 流程控制")]),t._v("小节里也略有提及这种方式。")]),t._v(" "),t._m(25),t._v(" "),t._m(26),t._v(" "),e("p",[t._v("不啰嗦，实践是检验真理的唯一标准")]),t._v(" "),t._m(27),e("p",[t._v("测试方法同上，测试结果：")]),t._v(" "),t._m(28),t._v(" "),t._m(29),t._v(" "),e("p",[t._v("但是随着执行环境和浏览器的不同，这些语法在执行速度上也会出现偏差甚至反转的情况，直接看图：")]),t._v(" "),t._m(30),t._v(" "),t._m(31),t._v(" "),t._m(32),t._v(" "),e("p",[t._v("可以看出：")]),t._v(" "),t._m(33),t._v(" "),t._m(34),t._v(" "),t._m(35)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"js数组循环的性能和效率分析（for、while、foreach、map、for-of）"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#js数组循环的性能和效率分析（for、while、foreach、map、for-of）","aria-hidden":"true"}},[this._v("#")]),this._v(" JS数组循环的性能和效率分析（for、while、forEach、map、for of）")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"前言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前言","aria-hidden":"true"}},[this._v("#")]),this._v(" 前言")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("p",[t._v("前端开发中经常涉及到数组的相关操作：去重、过滤、求和、数据二次处理等等。都需要我们对数组进行循环。为了满足各种需求，JS除了提供最简单的"),e("code",[t._v("for")]),t._v("循环，在"),e("code",[t._v("ES6")]),t._v("和后续版本中也新增的诸如："),e("code",[t._v("map、filter、some、reduce")]),t._v("等实用的方法。因为各个方法作用不同，简单的对所有涉及到循环的方法进行执行速度比较，是不公平的，也是毫无意义的。那么我们就针对"),e("strong",[t._v("最单纯的以取值为目的的循环")]),t._v("进行一次性能和效率测试，用肉眼可见的方式，对JS中常见的这些数组循环方式进行一次探讨。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"从最简单的for循环说起"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#从最简单的for循环说起","aria-hidden":"true"}},[this._v("#")]),this._v(" 从最简单的for循环说起")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"for循环常见的四种写法，不啰嗦，直接上代码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#for循环常见的四种写法，不啰嗦，直接上代码","aria-hidden":"true"}},[this._v("#")]),this._v(" "),s("code",[this._v("for")]),this._v("循环常见的四种写法，不啰嗦，直接上代码")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("const persons = ['郑昊川', '钟忠', '高晓波', '韦贵铁', '杨俊', '宋灿']\n// 方法一\nfor (let i = 0; i < persons.length; i++) {\n  console.log(persons[i])\n}\n// 方法二\nfor (let i = 0, len = persons.length; i < len; i++) {\n  console.log(persons[i])\n}\n// 方法三\nfor (let i = 0, person; person = persons[i]; i++) {\n  console.log(person)\n}\n// 方法四\nfor (let i = persons.length; i--;) {\n  console.log(persons[i])\n}\n复制代码\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("p",[this._v("第一种方法是最常见的方式，不解释。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("p",[this._v("第二种方法是将"),s("code",[this._v("persons.length")]),this._v("缓存到变量"),s("code",[this._v("len")]),this._v("中,这样每次循环时就不会再读取数组的长度。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("p",[this._v("第一步：先声明索引"),s("code",[this._v("i = 0")]),this._v("和变量"),s("code",[this._v("person")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("p",[this._v("第三步：执行循环体，打印"),s("code",[this._v("person")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("i++\n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("for (let i = 0, person; person = persons[i++];) {\n  console.log(person)\n}\n复制代码\n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br"),s("span",{staticClass:"line-number"},[this._v("2")]),s("br"),s("span",{staticClass:"line-number"},[this._v("3")]),s("br"),s("span",{staticClass:"line-number"},[this._v("4")]),s("br")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("li",[e("p",[t._v("第四种方法是倒序循环。执行的顺序是：")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("第一步：获取数组长度，赋值给变量"),e("code",[t._v("i")])])]),t._v(" "),e("li",[e("p",[t._v("第二步：判断"),e("code",[t._v("i")]),t._v("是否大于0并执行"),e("code",[t._v("i--")])])]),t._v(" "),e("li",[e("p",[t._v("第三步：执行循环体，打印")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("persons[i]\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("，此时的")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("i\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("已经")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("-1\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("了")]),t._v(" "),e("blockquote",[e("p",[t._v("从后向前，直到"),e("code",[t._v("i === 0")]),t._v("为止。这种方式不仅去除了每次循环中读取数组长度的操作,而且只创建了一个变量"),e("code",[t._v("i")]),t._v("。")])])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"四种for循环方式在数组浅拷贝中的性能和速度测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四种for循环方式在数组浅拷贝中的性能和速度测试","aria-hidden":"true"}},[this._v("#")]),this._v(" 四种"),s("code",[this._v("for")]),this._v("循环方式在数组浅拷贝中的性能和速度测试")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("先造一个足够长的数组作为要拷贝的目标(如果"),s("code",[this._v("i")]),this._v("值过大，到亿级左右，可能会抛出JS堆栈跟踪的报错)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("const ARR_SIZE = 6666666\nconst hugeArr = new Array(ARR_SIZE).fill(1)\n复制代码\n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br"),s("span",{staticClass:"line-number"},[this._v("2")]),s("br"),s("span",{staticClass:"line-number"},[this._v("3")]),s("br")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("/* node环境下记录方法执行前后内存中已用到的堆的差值 */\nfunction heapRecord(fun) {\n  if (process) {\n    const startHeap = process.memoryUsage().heapUsed\n    fun()\n    const endHeap = process.memoryUsage().heapUsed\n    const heapDiff = endHeap - startHeap\n    console.log('已用到的堆的差值: ', heapDiff)\n  } else {\n    fun()\n  }\n}\n复制代码\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("// 方法一，普通for循环\nfunction method1() {\n  var arrCopy = []\n  console.time('method1')\n  for (let i = 0; i < hugeArr.length; i++) {\n    arrCopy.push(hugeArr[i])\n  }\n  console.timeEnd('method1')\n}\n// 方法二，缓存长度\nfunction method2() {\n  var arrCopy = []\n  console.time('method2')\n  for (let i = 0, len = hugeArr.length; i < len; i++) {\n    arrCopy.push(hugeArr[i])\n  }\n  console.timeEnd('method2')\n}\n// 方法三，取值和判断合并\nfunction method3() {\n  var arrCopy = []\n  console.time('method3')\n  for (let i = 0, item; item = hugeArr[i]; i++) {\n    arrCopy.push(item)\n  }\n  console.timeEnd('method3')\n}\n// 方法四，i--与判断合并，倒序迭代\nfunction method4() {\n  var arrCopy = []\n  console.time('method4')\n  for (let i = hugeArr.length; i--;) {\n    arrCopy.push(hugeArr[i])\n  }\n  console.timeEnd('method4')\n}\n复制代码\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br"),e("span",{staticClass:"line-number"},[t._v("21")]),e("br"),e("span",{staticClass:"line-number"},[t._v("22")]),e("br"),e("span",{staticClass:"line-number"},[t._v("23")]),e("br"),e("span",{staticClass:"line-number"},[t._v("24")]),e("br"),e("span",{staticClass:"line-number"},[t._v("25")]),e("br"),e("span",{staticClass:"line-number"},[t._v("26")]),e("br"),e("span",{staticClass:"line-number"},[t._v("27")]),e("br"),e("span",{staticClass:"line-number"},[t._v("28")]),e("br"),e("span",{staticClass:"line-number"},[t._v("29")]),e("br"),e("span",{staticClass:"line-number"},[t._v("30")]),e("br"),e("span",{staticClass:"line-number"},[t._v("31")]),e("br"),e("span",{staticClass:"line-number"},[t._v("32")]),e("br"),e("span",{staticClass:"line-number"},[t._v("33")]),e("br"),e("span",{staticClass:"line-number"},[t._v("34")]),e("br"),e("span",{staticClass:"line-number"},[t._v("35")]),e("br"),e("span",{staticClass:"line-number"},[t._v("36")]),e("br"),e("span",{staticClass:"line-number"},[t._v("37")]),e("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("分别调用上述方法，每个方法重复执行12次,去除一个最大值和一个最小值，求平均值(四舍五入)，最终每个方法执行时间的结果如下表(测试机器："),s("code",[this._v("MacBook Pro (15-inch, 2017) 处理器：2.8 GHz Intel Core i7 内存：16 GB 2133 MHz LPDDR3")]),this._v(" 执行环境："),s("code",[this._v("node v10.8.0")]),this._v(")：")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("table",[e("thead",[e("tr",[e("th",[t._v("-")]),t._v(" "),e("th",[t._v("方法一")]),t._v(" "),e("th",[t._v("方法二")]),t._v(" "),e("th",[t._v("方法三")]),t._v(" "),e("th",[t._v("方法四")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("第一次")]),t._v(" "),e("td",[t._v("152.201ms")]),t._v(" "),e("td",[t._v("156.990ms")]),t._v(" "),e("td",[t._v("152.668ms")]),t._v(" "),e("td",[t._v("152.684ms")])]),t._v(" "),e("tr",[e("td",[t._v("第二次")]),t._v(" "),e("td",[t._v("150.047ms")]),t._v(" "),e("td",[t._v("159.166ms")]),t._v(" "),e("td",[t._v("159.333ms")]),t._v(" "),e("td",[t._v("152.455ms")])]),t._v(" "),e("tr",[e("td",[t._v("第三次")]),t._v(" "),e("td",[t._v("155.390ms")]),t._v(" "),e("td",[t._v("151.823ms")]),t._v(" "),e("td",[t._v("159.365ms")]),t._v(" "),e("td",[t._v("149.809ms")])]),t._v(" "),e("tr",[e("td",[t._v("第四次")]),t._v(" "),e("td",[t._v("153.195ms")]),t._v(" "),e("td",[t._v("155.994ms")]),t._v(" "),e("td",[t._v("155.325ms")]),t._v(" "),e("td",[t._v("150.562ms")])]),t._v(" "),e("tr",[e("td",[t._v("第五次")]),t._v(" "),e("td",[t._v("151.823ms")]),t._v(" "),e("td",[t._v("154.689ms")]),t._v(" "),e("td",[t._v("156.483ms")]),t._v(" "),e("td",[t._v("148.067ms")])]),t._v(" "),e("tr",[e("td",[t._v("第六次")]),t._v(" "),e("td",[t._v("152.715ms")]),t._v(" "),e("td",[t._v("154.677ms")]),t._v(" "),e("td",[t._v("153.135ms")]),t._v(" "),e("td",[t._v("150.787ms")])]),t._v(" "),e("tr",[e("td",[t._v("第七次")]),t._v(" "),e("td",[t._v("152.084ms")]),t._v(" "),e("td",[t._v("152.587ms")]),t._v(" "),e("td",[t._v("157.458ms")]),t._v(" "),e("td",[t._v("152.572ms")])]),t._v(" "),e("tr",[e("td",[t._v("第八次")]),t._v(" "),e("td",[t._v("152.509ms")]),t._v(" "),e("td",[t._v("153.781ms")]),t._v(" "),e("td",[t._v("153.277ms")]),t._v(" "),e("td",[t._v("152.263ms")])]),t._v(" "),e("tr",[e("td",[t._v("第九次")]),t._v(" "),e("td",[t._v("154.363ms")]),t._v(" "),e("td",[t._v("156.497ms")]),t._v(" "),e("td",[t._v("151.002ms")]),t._v(" "),e("td",[t._v("154.310ms")])]),t._v(" "),e("tr",[e("td",[t._v("第十次")]),t._v(" "),e("td",[t._v("153.784ms")]),t._v(" "),e("td",[t._v("155.612ms")]),t._v(" "),e("td",[t._v("161.767ms")]),t._v(" "),e("td",[t._v("153.487ms")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("平均耗时")])]),t._v(" "),e("td",[e("strong",[t._v("152.811ms")])]),t._v(" "),e("td",[e("strong",[t._v("155.182ms")])]),t._v(" "),e("td",[e("strong",[t._v("155.981ms")])]),t._v(" "),e("td",[e("strong",[t._v("151.700ms")])])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("用栈差值")])]),t._v(" "),e("td",[e("strong",[t._v("238511136Byte")])]),t._v(" "),e("td",[e("strong",[t._v("238511352Byte")])]),t._v(" "),e("td",[e("strong",[t._v("238512048Byte")])]),t._v(" "),e("td",[e("strong",[t._v("238511312Byte")])])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("意不意外？惊不惊喜？想象之中至少方法二肯定比方法一更快的！但事实并非如此，不相信眼前事实的我又测试了很多次，包括改变被拷贝的数组的长度，长度从百级到千万级。最后发现：在"),s("code",[this._v("node")]),this._v("下执行完成同一个数组的浅拷贝任务，耗时方面四种方法的差距微乎其微，有时候排序甚至略有波动。 内存占用方面："),s("strong",[this._v("方法一 < 方法四 < 方法二 < 方法三")]),this._v("，但差距也很小。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("同样是"),s("code",[this._v("v8引擎")]),this._v("的"),s("code",[this._v("谷歌浏览器")]),this._v("，测试发现四种方法也都非常接近。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("但是在"),s("code",[this._v("火狐浏览器")]),this._v("中的测试结果："),s("strong",[this._v("方法二 ≈ 方法三 ≈ 方法四 < 方法一")]),this._v("，表明二三四这三种写法都可以在一定程度上优化"),s("code",[this._v("for循环")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("而在"),s("code",[this._v("safari浏览器下")]),this._v("："),s("strong",[this._v("方法四 < 方法一 ≈ 方法二 ≈ 方法三")]),this._v("，只有"),s("strong",[this._v("方法四")]),this._v("体现出了小幅度的优化效果。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"小结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#小结","aria-hidden":"true"}},[this._v("#")]),this._v(" 小结")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("p",[e("code",[t._v("不推荐")]),t._v("："),e("strong",[t._v("第三种")]),t._v("方式。主要是因为当数组里存在非"),e("code",[t._v("Truthy")]),t._v("的值时，比如"),e("code",[t._v("0")]),t._v("和"),e("code",[t._v("''")]),t._v("，会导致循环直接结束。")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("h2",{attrs:{id:"while循环以及es6-的新语法foreach、map和for-of，会更快吗？"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#while循环以及es6-的新语法foreach、map和for-of，会更快吗？","aria-hidden":"true"}},[t._v("#")]),t._v(" "),e("code",[t._v("while")]),t._v("循环以及"),e("code",[t._v("ES6+的新语法forEach")]),t._v("、"),e("code",[t._v("map")]),t._v("和"),e("code",[t._v("for of")]),t._v("，会更快吗？")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("// 方法五，while\nfunction method5() {\n  var arrCopy = []\n  console.time('method5')\n  let i = 0\n  while (i < hugeArr.length) {\n    arrCopy.push(hugeArr[i++])\n  }\n  console.timeEnd('method5')\n}\n// 方法六,forEach\nfunction method6() {\n  var arrCopy = []\n  console.time('method6')\n  hugeArr.forEach((item) => {\n    arrCopy.push(item)\n  })\n  console.timeEnd('method6')\n}\n// 方法七,map\nfunction method7() {\n  var arrCopy = []\n  console.time('method7')\n  arrCopy = hugeArr.map(item => item)\n  console.timeEnd('method7')\n}\n// 方法八,for of\nfunction method8() {\n  var arrCopy = []\n  console.time('method8')\n  for (let item of hugeArr) {\n    arrCopy.push(item)\n  }\n  console.timeEnd('method8')\n}\n复制代码\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br"),e("span",{staticClass:"line-number"},[t._v("21")]),e("br"),e("span",{staticClass:"line-number"},[t._v("22")]),e("br"),e("span",{staticClass:"line-number"},[t._v("23")]),e("br"),e("span",{staticClass:"line-number"},[t._v("24")]),e("br"),e("span",{staticClass:"line-number"},[t._v("25")]),e("br"),e("span",{staticClass:"line-number"},[t._v("26")]),e("br"),e("span",{staticClass:"line-number"},[t._v("27")]),e("br"),e("span",{staticClass:"line-number"},[t._v("28")]),e("br"),e("span",{staticClass:"line-number"},[t._v("29")]),e("br"),e("span",{staticClass:"line-number"},[t._v("30")]),e("br"),e("span",{staticClass:"line-number"},[t._v("31")]),e("br"),e("span",{staticClass:"line-number"},[t._v("32")]),e("br"),e("span",{staticClass:"line-number"},[t._v("33")]),e("br"),e("span",{staticClass:"line-number"},[t._v("34")]),e("br"),e("span",{staticClass:"line-number"},[t._v("35")]),e("br"),e("span",{staticClass:"line-number"},[t._v("36")]),e("br")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("table",[e("thead",[e("tr",[e("th",[t._v("-")]),t._v(" "),e("th",[t._v("方法五")]),t._v(" "),e("th",[t._v("方法六")]),t._v(" "),e("th",[t._v("方法七")]),t._v(" "),e("th",[t._v("方法八")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("第一次")]),t._v(" "),e("td",[t._v("151.380ms")]),t._v(" "),e("td",[t._v("221.332ms")]),t._v(" "),e("td",[t._v("875.402ms")]),t._v(" "),e("td",[t._v("240.411ms")])]),t._v(" "),e("tr",[e("td",[t._v("第二次")]),t._v(" "),e("td",[t._v("152.031ms")]),t._v(" "),e("td",[t._v("223.436ms")]),t._v(" "),e("td",[t._v("877.112ms")]),t._v(" "),e("td",[t._v("237.208ms")])]),t._v(" "),e("tr",[e("td",[t._v("第三次")]),t._v(" "),e("td",[t._v("150.442ms")]),t._v(" "),e("td",[t._v("221.853ms")]),t._v(" "),e("td",[t._v("876.829ms")]),t._v(" "),e("td",[t._v("253.744ms")])]),t._v(" "),e("tr",[e("td",[t._v("第四次")]),t._v(" "),e("td",[t._v("151.319ms")]),t._v(" "),e("td",[t._v("222.672ms")]),t._v(" "),e("td",[t._v("875.270ms")]),t._v(" "),e("td",[t._v("243.165ms")])]),t._v(" "),e("tr",[e("td",[t._v("第五次")]),t._v(" "),e("td",[t._v("150.142ms")]),t._v(" "),e("td",[t._v("222.953ms")]),t._v(" "),e("td",[t._v("877.940ms")]),t._v(" "),e("td",[t._v("237.825ms")])]),t._v(" "),e("tr",[e("td",[t._v("第六次")]),t._v(" "),e("td",[t._v("155.226ms")]),t._v(" "),e("td",[t._v("225.441ms")]),t._v(" "),e("td",[t._v("879.223ms")]),t._v(" "),e("td",[t._v("240.648ms")])]),t._v(" "),e("tr",[e("td",[t._v("第七次")]),t._v(" "),e("td",[t._v("151.254ms")]),t._v(" "),e("td",[t._v("219.965ms")]),t._v(" "),e("td",[t._v("883.324ms")]),t._v(" "),e("td",[t._v("238.197ms")])]),t._v(" "),e("tr",[e("td",[t._v("第八次")]),t._v(" "),e("td",[t._v("151.632ms")]),t._v(" "),e("td",[t._v("218.274ms")]),t._v(" "),e("td",[t._v("878.331ms")]),t._v(" "),e("td",[t._v("240.940ms")])]),t._v(" "),e("tr",[e("td",[t._v("第九次")]),t._v(" "),e("td",[t._v("151.412ms")]),t._v(" "),e("td",[t._v("223.189ms")]),t._v(" "),e("td",[t._v("873.318ms")]),t._v(" "),e("td",[t._v("256.644ms")])]),t._v(" "),e("tr",[e("td",[t._v("第十次")]),t._v(" "),e("td",[t._v("155.563ms")]),t._v(" "),e("td",[t._v("220.595ms")]),t._v(" "),e("td",[t._v("881.203ms")]),t._v(" "),e("td",[t._v("234.534ms")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("平均耗时")])]),t._v(" "),e("td",[e("strong",[t._v("152.040ms")])]),t._v(" "),e("td",[e("strong",[t._v("221.971ms")])]),t._v(" "),e("td",[e("strong",[t._v("877.795ms")])]),t._v(" "),e("td",[e("strong",[t._v("242.332ms")])])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("用栈差值")])]),t._v(" "),e("td",[e("strong",[t._v("238511400Byte")])]),t._v(" "),e("td",[e("strong",[t._v("238511352Byte")])]),t._v(" "),e("td",[e("strong",[t._v("53887824Byte")])]),t._v(" "),e("td",[e("strong",[t._v("191345296Byte")])])])])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("p",[t._v("在"),e("code",[t._v("node")]),t._v("下，由上面的数据可以很明显的看出，"),e("code",[t._v("forEach")]),t._v("、"),e("code",[t._v("map")]),t._v("和"),e("code",[t._v("for of")]),t._v(" 这些"),e("code",[t._v("ES6+")]),t._v("的语法并没有传统的"),e("code",[t._v("for")]),t._v("循环或者"),e("code",[t._v("while")]),t._v("循环快，特别是"),e("code",[t._v("map")]),t._v("方法。但是由于"),e("code",[t._v("map")]),t._v("有返回值，无需额外调用新数组的"),e("code",[t._v("push")]),t._v("方法，所以在执行浅拷贝任务上，内存占用很低。而"),e("code",[t._v("for of")]),t._v("语法在内存占用上也有一定的优势。顺便提一下："),e("code",[t._v("for循环 while循环 for of 循环")]),t._v("是可以通过"),e("code",[t._v("break")]),t._v("关键字跳出的，而"),e("code",[t._v("forEach map")]),t._v("这种循环是无法跳出的。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("谷歌浏览器")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("火狐浏览器")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("safari浏览器下")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ol",[e("li",[t._v("谷歌浏览器中"),e("code",[t._v("ES6+")]),t._v("的循环语法会普遍比传统的循环语法慢，但是火狐和safari中情况却几乎相反。")]),t._v(" "),e("li",[t._v("谷歌浏览器的各种循环语法的执行耗时上差距并不大。但"),e("code",[t._v("map")]),t._v("特殊，速度明显比其他几种语法慢，而在火狐和safari中却出现了反转，"),e("code",[t._v("map")]),t._v("反而比较快！")]),t._v(" "),e("li",[t._v("苹果大法好")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结","aria-hidden":"true"}},[this._v("#")]),this._v(" 总结")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("p",[t._v("之前有听到过诸如“缓存数组长度可以提高循环效率”或者“ES6的循环语法更高效”的说法。说者无心，听者有意，事实究竟如何，实践出真知。抛开业务场景和使用便利性，单纯谈性能和效率是没有意义的。 ES6新增的诸多数组的方法确实极大的方便了前端开发，使得以往复杂或者冗长的代码，可以变得易读而且精炼，而好的"),e("code",[t._v("for")]),t._v("循环写法，在大数据量的情况下，确实也有着更好的兼容和多环境运行表现。当然本文的讨论也只是基于观察的一种总结，并没有深入底层。而随着浏览器的更新，这些方法的孰优孰劣也可能成为玄学。目前发现在"),e("code",[t._v("Chrome Canary 70.0.3513.0")]),t._v("下"),e("code",[t._v("for of")]),t._v(" 会明显比"),e("code",[t._v("Chrome 68.0.3440.84")]),t._v("快。如果你有更深入的见解或者文章，也不妨在评论区分享，小弟的这篇文章也权当抛砖引玉。如果你对数组的其他循环方法的性能和效率也感兴趣，不妨自己动手试一试，也欢迎评论交流。")])}],!1,null,null,null);r.options.__file="JS数组循环的性能和效率分析（for、while、forEach、map、for of）.md";s.default=r.exports}}]);